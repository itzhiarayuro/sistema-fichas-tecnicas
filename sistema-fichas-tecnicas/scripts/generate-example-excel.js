const XLSX = require('xlsx');
const path = require('path');
const fs = require('fs');

const fields = [
    'ID_POZO', 'PROYECTO', 'FECHA_INSPECCION', 'INSPECTOR', 'LOCALIDAD', 'DIRECCION',
    'ESTADO_FISICO', 'MATERIAL_CONSTRUCCION', 'DIAMETRO_MM', 'PROFUNDIDAD_M',
    'COORD_X', 'COORD_Y', 'ALTITUD_MSNM', 'TIPO_TAPA', 'ESTADO_TAPA',
    'TIENE_SUMIDERO', 'TIENE_ENTRADA', 'TIENE_SALIDA', 'NUM_ENTRADAS',
    'MATERIAL_TUBERIA', 'OBSERVACIONES', 'ESTADO_INTERNO', 'SEDIMENTOS',
    'VEGETACION', 'REJILLA_SUMIDERO', 'NIVEL_AGUA_M', 'CAUDAL_ESTIMADO',
    'TIPO_SUELO', 'ACCESO_CRITICO', 'REQUIERE_LIMPIEZA', 'FECHA_ULT_MANT',
    'ZONA_RIESGO', 'IMPORTANCIA_RED'
];

const data = [
    {
        'ID_POZO': 'PZ1666',
        'PROYECTO': 'Mantenimiento Red Sur',
        'FECHA_INSPECCION': '2024-01-10',
        'INSPECTOR': 'Juan Pérez',
        'LOCALIDAD': 'Fontibón',
        'DIRECCION': 'Calle 13 # 100-24',
        'ESTADO_FISICO': 'Bueno',
        'MATERIAL_CONSTRUCCION': 'Concreto',
        'DIAMETRO_MM': 1200,
        'PROFUNDIDAD_M': 3.5,
        'COORD_X': 4.6789,
        'COORD_Y': -74.1234,
        'ALTITUD_MSNM': 2600,
        'TIPO_TAPA': 'Fundición',
        'ESTADO_TAPA': 'Excelente',
        'TIENE_SUMIDERO': 'NO',
        'TIENE_ENTRADA': 'SI',
        'TIENE_SALIDA': 'SI',
        'NUM_ENTRADAS': 1,
        'MATERIAL_TUBERIA': 'PVC',
        'OBSERVACIONES': 'Pozo en óptimas condiciones',
        'ESTADO_INTERNO': 'Limpio',
        'SEDIMENTOS': 'Bajo',
        'VEGETACION': 'Ninguna',
        'REJILLA_SUMIDERO': 'N/A',
        'NIVEL_AGUA_M': 0.5,
        'CAUDAL_ESTIMADO': 'Medio',
        'TIPO_SUELO': 'Pavimento',
        'ACCESO_CRITICO': 'NO',
        'REQUIERE_LIMPIEZA': 'NO',
        'FECHA_ULT_MANT': '2023-06-15',
        'ZONA_RIESGO': 'Baja',
        'IMPORTANCIA_RED': 'Alta'
    },
    {
        'ID_POZO': 'PZ1667',
        'PROYECTO': 'Mantenimiento Red Sur',
        'FECHA_INSPECCION': '2024-01-11',
        'INSPECTOR': 'Juan Pérez',
        'LOCALIDAD': 'Fontibón',
        'DIRECCION': 'Carrera 100 # 12-45',
        'ESTADO_FISICO': 'Regular',
        'MATERIAL_CONSTRUCCION': 'Ladrillo',
        'DIAMETRO_MM': 1000,
        'PROFUNDIDAD_M': 2.8,
        'COORD_X': 4.6790,
        'COORD_Y': -74.1235,
        'ALTITUD_MSNM': 2601,
        'TIPO_TAPA': 'Concreto',
        'ESTADO_TAPA': 'Deteriorado',
        'TIENE_SUMIDERO': 'SI',
        'TIENE_ENTRADA': 'SI',
        'TIENE_SALIDA': 'SI',
        'NUM_ENTRADAS': 2,
        'MATERIAL_TUBERIA': 'Gres',
        'OBSERVACIONES': 'Requiere cambio de tapa próximamente',
        'ESTADO_INTERNO': 'Con residuos',
        'SEDIMENTOS': 'Medio',
        'VEGETACION': 'Algo de musgo',
        'REJILLA_SUMIDERO': 'Regular',
        'NIVEL_AGUA_M': 1.2,
        'CAUDAL_ESTIMADO': 'Bajo',
        'TIPO_SUELO': 'Tierra',
        'ACCESO_CRITICO': 'SI',
        'REQUIERE_LIMPIEZA': 'SI',
        'FECHA_ULT_MANT': '2022-01-10',
        'ZONA_RIESGO': 'Media',
        'IMPORTANCIA_RED': 'Media'
    },
    {
        'ID_POZO': 'PZ1668',
        'PROYECTO': 'Emergencias Climáticas',
        'FECHA_INSPECCION': '2024-01-12',
        'INSPECTOR': 'María López',
        'LOCALIDAD': 'Kennedy',
        'DIRECCION': 'Av. Ciudad de Cali # 38 Sur',
        'ESTADO_FISICO': 'Crítico',
        'MATERIAL_CONSTRUCCION': 'Otro',
        'DIAMETRO_MM': 800,
        'PROFUNDIDAD_M': 4.2,
        'COORD_X': 4.6500,
        'COORD_Y': -74.1500,
        'ALTITUD_MSNM': 2595,
        'TIPO_TAPA': 'Sin tapa',
        'ESTADO_TAPA': 'N/A',
        'TIENE_SUMIDERO': 'NO',
        'TIENE_ENTRADA': 'SI',
        'TIENE_SALIDA': 'SI',
        'NUM_ENTRADAS': 1,
        'MATERIAL_TUBERIA': 'Concreto',
        'OBSERVACIONES': 'URGENTE: Pozo destapado en vía principal',
        'ESTADO_INTERNO': 'Obstruido',
        'SEDIMENTOS': 'Muy Alto',
        'VEGETACION': 'Abundante',
        'REJILLA_SUMIDERO': 'N/A',
        'NIVEL_AGUA_M': 3.0,
        'CAUDAL_ESTIMADO': 'Nulo',
        'TIPO_SUELO': 'Asfalto',
        'ACCESO_CRITICO': 'SI',
        'REQUIERE_LIMPIEZA': 'SÍ, INMEDIATA',
        'FECHA_ULT_MANT': 'Desconocida',
        'ZONA_RIESGO': 'Muy Alta',
        'IMPORTANCIA_RED': 'Crítica'
    },
    {
        'ID_POZO': 'PZ1669',
        'PROYECTO': 'Catastro 2024',
        'FECHA_INSPECCION': '2024-01-13',
        'INSPECTOR': 'Andrés Castro',
        'LOCALIDAD': 'Engativá',
        'DIRECCION': 'Transversal 94L # 80-10',
        'ESTADO_FISICO': 'Bueno',
        'MATERIAL_CONSTRUCCION': 'Concreto',
        'DIAMETRO_MM': 1500,
        'PROFUNDIDAD_M': 1.5,
        'COORD_X': '',
        'COORD_Y': '',
        'ALTITUD_MSNM': 2605,
        'TIPO_TAPA': 'Metal',
        'ESTADO_TAPA': 'Bueno',
        'TIENE_SUMIDERO': 'SI',
        'TIENE_ENTRADA': 'NO',
        'TIENE_SALIDA': 'SI',
        'NUM_ENTRADAS': 0,
        'MATERIAL_TUBERIA': 'HDPE',
        'OBSERVACIONES': 'Coordenadas no tomadas por falla en GPS',
        'ESTADO_INTERNO': 'Seco',
        'SEDIMENTOS': 'Nulo',
        'VEGETACION': 'Ninguna',
        'REJILLA_SUMIDERO': 'Bueno',
        'NIVEL_AGUA_M': 0.0,
        'CAUDAL_ESTIMADO': 'Nulo',
        'TIPO_SUELO': 'Andén',
        'ACCESO_CRITICO': 'NO',
        'REQUIERE_LIMPIEZA': 'NO',
        'FECHA_ULT_MANT': '2023-12-01',
        'ZONA_RIESGO': 'Baja',
        'IMPORTANCIA_RED': 'Baja'
    },
    {
        'ID_POZO': 'PZ1670',
        'PROYECTO': 'Catastro 2024',
        'FECHA_INSPECCION': '2024-01-13',
        'INSPECTOR': 'Andrés Castro',
        'LOCALIDAD': 'Engativá',
        'DIRECCION': 'Carrera 94 # 81-05',
        'ESTADO_FISICO': 'Regular',
        'MATERIAL_CONSTRUCCION': 'Concreto',
        'DIAMETRO_MM': 1100,
        'PROFUNDIDAD_M': 2.2,
        'COORD_X': 4.7001,
        'COORD_Y': -74.1100,
        'ALTITUD_MSNM': 2602,
        'TIPO_TAPA': 'Fundición',
        'ESTADO_TAPA': 'Manchado',
        'TIENE_SUMIDERO': 'NO',
        'TIENE_ENTRADA': 'SI',
        'TIENE_SALIDA': 'SI',
        'NUM_ENTRADAS': 1,
        'MATERIAL_TUBERIA': 'PVC',
        'OBSERVACIONES': 'Datos parciales por lluvia intensa',
        'ESTADO_INTERNO': 'Húmedo',
        'SEDIMENTOS': 'Bajo',
        'VEGETACION': 'Ninguna',
        'REJILLA_SUMIDERO': 'N/A',
        'NIVEL_AGUA_M': 0.2,
        'CAUDAL_ESTIMADO': 'Bajo',
        'TIPO_SUELO': 'Pavimento',
        'ACCESO_CRITICO': 'NO',
        'REQUIERE_LIMPIEZA': 'NO',
        'FECHA_ULT_MANT': '2023-10-10',
        'ZONA_RIESGO': 'Baja',
        'IMPORTANCIA_RED': 'Media'
    }
];

const wb = XLSX.utils.book_new();
const ws = XLSX.utils.json_to_sheet(data, { header: fields });
XLSX.utils.book_append_sheet(wb, ws, 'Datos Pozos');

const filePath = path.join(__dirname, 'public', 'archivos-prueba', 'ejemplo_completo_33campos.xlsx');
XLSX.writeFile(wb, filePath);

console.log('Excel generado exitosamente en: ' + filePath);
